function main() {
  var sheet = createSheetAndWriteData();
  
  // Call the function to update the table data in the new sheet
  updateTableDataInSheets(sheet);
}

function createSheetAndWriteData() {
  // Open the spreadsheet
  var spreadsheet = SpreadsheetApp.openById('sheet-id'); 
  var scriptProperties = PropertiesService.getScriptProperties();

  // Get the current count
  var count = scriptProperties.getProperty('sheetCount');
  if (count == null) {
    // If count is not set yet, start it at 1
    count = 1;
  } else {
    // Otherwise, parse it as an integer and increment it
    count = parseInt(count) + 1;
  }

  // Store the incremented count back to the script properties
  scriptProperties.setProperty('sheetCount', count.toString());

  // Create a new sheet with the count in its name
  var sheetName = count + '.Imported OKRs ';
  var sheet = spreadsheet.insertSheet(sheetName);

  return sheet;
}

function updateTableDataInSheets(sheet) {
  var doc = DocumentApp.openById('document-id');
  var body = doc.getBody();
  var tables = body.getTables();
  

  for (var i = 0; i < tables.length; i++) {
    var table = tables[i];
    for (var row = 0; row < table.getNumRows(); row++) {
      for (var col = 0; col < table.getRow(row).getNumCells(); col++) {
        var cellText = table.getCell(row, col).getText();
        console.log(row),  console.log(col)
        console.log(cellText)
        sheet.getRange(row+1, col+1).setValue(cellText);
        lastColumn = col;
      }
    }
  }
  // Set the column titles
  var titles = ['Impact [1-0]', 'Confidence [1-10]', 'Ease of Implementation [1-10]', 'ICE Score [I*C*E'];
   for (var i = 0; i < titles.length; i++) {
    sheet.getRange(1, lastColumn + 2 + i).setValue(titles[i]);
  }

  // Set labels for the first two columns
  label1= sheet.getRange(1, 1).setValue('Category');
  sheet.getRange(1, 2).setValue('OKR');
  }
